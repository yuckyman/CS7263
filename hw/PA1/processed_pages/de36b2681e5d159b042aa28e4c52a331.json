[
  "distributed",
  "indexing",
  "next",
  "dynamic",
  "indexing",
  "up",
  "index",
  "construction",
  "previous",
  "singlepass",
  "inmemory",
  "indexing",
  "contents",
  "index",
  "distributed",
  "indexing",
  "collections",
  "are",
  "often",
  "so",
  "large",
  "that",
  "we",
  "can",
  "not",
  "perform",
  "index",
  "construction",
  "efficiently",
  "on",
  "a",
  "single",
  "machine",
  "this",
  "is",
  "particularly",
  "true",
  "of",
  "the",
  "world",
  "wide",
  "web",
  "for",
  "which",
  "we",
  "need",
  "large",
  "computer",
  "clusters",
  "to",
  "construct",
  "any",
  "reasonably",
  "sized",
  "web",
  "index",
  "web",
  "search",
  "engines",
  "therefore",
  "use",
  "distributed",
  "indexing",
  "algorithms",
  "for",
  "index",
  "construction",
  "the",
  "result",
  "of",
  "the",
  "construction",
  "process",
  "is",
  "a",
  "distributed",
  "index",
  "that",
  "is",
  "partitioned",
  "across",
  "several",
  "machines",
  "either",
  "according",
  "to",
  "term",
  "or",
  "according",
  "to",
  "document",
  "in",
  "this",
  "section",
  "we",
  "describe",
  "distributed",
  "indexing",
  "for",
  "a",
  "termpartitioned",
  "index",
  "most",
  "large",
  "search",
  "engines",
  "prefer",
  "a",
  "documentpartitioned",
  "index",
  "which",
  "can",
  "be",
  "easily",
  "generated",
  "from",
  "a",
  "termpartitioned",
  "index",
  "we",
  "discuss",
  "this",
  "topic",
  "further",
  "in",
  "section",
  "203",
  "page",
  "the",
  "distributed",
  "index",
  "construction",
  "method",
  "we",
  "describe",
  "in",
  "this",
  "section",
  "is",
  "an",
  "application",
  "of",
  "mapreduce",
  "a",
  "general",
  "architecture",
  "for",
  "distributed",
  "computing",
  "mapreduce",
  "is",
  "designed",
  "for",
  "large",
  "computer",
  "clusters",
  "the",
  "point",
  "of",
  "a",
  "cluster",
  "is",
  "to",
  "solve",
  "large",
  "computing",
  "problems",
  "on",
  "cheap",
  "commodity",
  "machines",
  "or",
  "nodes",
  "that",
  "are",
  "built",
  "from",
  "standard",
  "parts",
  "processor",
  "memory",
  "disk",
  "as",
  "opposed",
  "to",
  "on",
  "a",
  "supercomputer",
  "with",
  "specialized",
  "hardware",
  "although",
  "hundreds",
  "or",
  "thousands",
  "of",
  "machines",
  "are",
  "available",
  "in",
  "such",
  "clusters",
  "individual",
  "machines",
  "can",
  "fail",
  "at",
  "any",
  "time",
  "one",
  "requirement",
  "for",
  "robust",
  "distributed",
  "indexing",
  "is",
  "therefore",
  "that",
  "we",
  "divide",
  "the",
  "work",
  "up",
  "into",
  "chunks",
  "that",
  "we",
  "can",
  "easily",
  "assign",
  "and",
  "in",
  "case",
  "of",
  "failure",
  "reassign",
  "a",
  "master",
  "node",
  "directs",
  "the",
  "process",
  "of",
  "assigning",
  "and",
  "reassigning",
  "tasks",
  "to",
  "individual",
  "worker",
  "nodes",
  "the",
  "map",
  "and",
  "reduce",
  "phases",
  "of",
  "mapreduce",
  "split",
  "up",
  "the",
  "computing",
  "job",
  "into",
  "chunks",
  "that",
  "standard",
  "machines",
  "can",
  "process",
  "in",
  "a",
  "short",
  "time",
  "the",
  "various",
  "steps",
  "of",
  "mapreduce",
  "are",
  "shown",
  "in",
  "figure",
  "45",
  "and",
  "an",
  "example",
  "on",
  "a",
  "collection",
  "consisting",
  "of",
  "two",
  "documents",
  "is",
  "shown",
  "in",
  "figure",
  "46",
  "first",
  "the",
  "input",
  "data",
  "in",
  "our",
  "case",
  "a",
  "collection",
  "of",
  "web",
  "pages",
  "are",
  "split",
  "into",
  "splits",
  "where",
  "the",
  "size",
  "of",
  "the",
  "split",
  "is",
  "chosen",
  "to",
  "ensure",
  "that",
  "the",
  "work",
  "can",
  "be",
  "distributed",
  "evenly",
  "chunks",
  "should",
  "not",
  "be",
  "too",
  "large",
  "and",
  "efficiently",
  "the",
  "total",
  "number",
  "of",
  "chunks",
  "we",
  "need",
  "to",
  "manage",
  "should",
  "not",
  "be",
  "too",
  "large",
  "16",
  "or",
  "64",
  "mb",
  "are",
  "good",
  "sizes",
  "in",
  "distributed",
  "indexing",
  "splits",
  "are",
  "not",
  "preassigned",
  "to",
  "machines",
  "but",
  "are",
  "instead",
  "assigned",
  "by",
  "the",
  "master",
  "node",
  "on",
  "an",
  "ongoing",
  "basis",
  "as",
  "a",
  "machine",
  "finishes",
  "processing",
  "one",
  "split",
  "it",
  "is",
  "assigned",
  "the",
  "next",
  "one",
  "if",
  "a",
  "machine",
  "dies",
  "or",
  "becomes",
  "a",
  "laggard",
  "due",
  "to",
  "hardware",
  "problems",
  "the",
  "split",
  "it",
  "is",
  "working",
  "on",
  "is",
  "simply",
  "reassigned",
  "to",
  "another",
  "machine",
  "figure",
  "45",
  "an",
  "example",
  "of",
  "distributed",
  "indexing",
  "with",
  "mapreduce",
  "adapted",
  "from",
  "dean",
  "and",
  "ghemawat",
  "2004",
  "in",
  "general",
  "mapreduce",
  "breaks",
  "a",
  "large",
  "computing",
  "problem",
  "into",
  "smaller",
  "parts",
  "by",
  "recasting",
  "it",
  "in",
  "terms",
  "of",
  "manipulation",
  "of",
  "keyvalue",
  "pairs",
  "for",
  "indexing",
  "a",
  "keyvalue",
  "pair",
  "has",
  "the",
  "form",
  "termiddocid",
  "in",
  "distributed",
  "indexing",
  "the",
  "mapping",
  "from",
  "terms",
  "to",
  "termids",
  "is",
  "also",
  "distributed",
  "and",
  "therefore",
  "more",
  "complex",
  "than",
  "in",
  "singlemachine",
  "indexing",
  "a",
  "simple",
  "solution",
  "is",
  "to",
  "maintain",
  "a",
  "perhaps",
  "precomputed",
  "mapping",
  "for",
  "frequent",
  "terms",
  "that",
  "is",
  "copied",
  "to",
  "all",
  "nodes",
  "and",
  "to",
  "use",
  "terms",
  "directly",
  "instead",
  "of",
  "termids",
  "for",
  "infrequent",
  "terms",
  "we",
  "do",
  "not",
  "address",
  "this",
  "problem",
  "here",
  "and",
  "assume",
  "that",
  "all",
  "nodes",
  "share",
  "a",
  "consistent",
  "term",
  "termid",
  "mapping",
  "the",
  "map",
  "phase",
  "of",
  "mapreduce",
  "consists",
  "of",
  "mapping",
  "splits",
  "of",
  "the",
  "input",
  "data",
  "to",
  "keyvalue",
  "pairs",
  "this",
  "is",
  "the",
  "same",
  "parsing",
  "task",
  "we",
  "also",
  "encountered",
  "in",
  "bsbi",
  "and",
  "spimi",
  "and",
  "we",
  "therefore",
  "call",
  "the",
  "machines",
  "that",
  "execute",
  "the",
  "map",
  "phase",
  "parsers",
  "each",
  "parser",
  "writes",
  "its",
  "output",
  "to",
  "local",
  "intermediate",
  "files",
  "the",
  "segment",
  "files",
  "shown",
  "as",
  "in",
  "figure",
  "45",
  "for",
  "the",
  "reduce",
  "phase",
  "we",
  "want",
  "all",
  "values",
  "for",
  "a",
  "given",
  "key",
  "to",
  "be",
  "stored",
  "close",
  "together",
  "so",
  "that",
  "they",
  "can",
  "be",
  "read",
  "and",
  "processed",
  "quickly",
  "this",
  "is",
  "achieved",
  "by",
  "partitioning",
  "the",
  "keys",
  "into",
  "term",
  "partitions",
  "and",
  "having",
  "the",
  "parsers",
  "write",
  "keyvalue",
  "pairs",
  "for",
  "each",
  "term",
  "partition",
  "into",
  "a",
  "separate",
  "segment",
  "file",
  "in",
  "figure",
  "45",
  "the",
  "term",
  "partitions",
  "are",
  "according",
  "to",
  "first",
  "letter",
  "af",
  "gp",
  "qz",
  "and",
  "we",
  "chose",
  "these",
  "key",
  "ranges",
  "for",
  "ease",
  "of",
  "exposition",
  "in",
  "general",
  "key",
  "ranges",
  "need",
  "not",
  "correspond",
  "to",
  "contiguous",
  "terms",
  "or",
  "termids",
  "the",
  "term",
  "partitions",
  "are",
  "defined",
  "by",
  "the",
  "person",
  "who",
  "operates",
  "the",
  "indexing",
  "system",
  "exercise",
  "46",
  "the",
  "parsers",
  "then",
  "write",
  "corresponding",
  "segment",
  "files",
  "one",
  "for",
  "each",
  "term",
  "partition",
  "each",
  "term",
  "partition",
  "thus",
  "corresponds",
  "to",
  "segments",
  "files",
  "where",
  "is",
  "the",
  "number",
  "of",
  "parsers",
  "for",
  "instance",
  "figure",
  "45",
  "shows",
  "three",
  "af",
  "segment",
  "files",
  "of",
  "the",
  "af",
  "partition",
  "corresponding",
  "to",
  "the",
  "three",
  "parsers",
  "shown",
  "in",
  "the",
  "figure",
  "collecting",
  "all",
  "values",
  "here",
  "docids",
  "for",
  "a",
  "given",
  "key",
  "here",
  "termid",
  "into",
  "one",
  "list",
  "is",
  "the",
  "task",
  "of",
  "the",
  "inverters",
  "in",
  "the",
  "reduce",
  "phase",
  "the",
  "master",
  "assigns",
  "each",
  "term",
  "partition",
  "to",
  "a",
  "different",
  "inverter",
  "and",
  "as",
  "in",
  "the",
  "case",
  "of",
  "parsers",
  "reassigns",
  "term",
  "partitions",
  "in",
  "case",
  "of",
  "failing",
  "or",
  "slow",
  "inverters",
  "each",
  "term",
  "partition",
  "corresponding",
  "to",
  "segment",
  "files",
  "one",
  "on",
  "each",
  "parser",
  "is",
  "processed",
  "by",
  "one",
  "inverter",
  "we",
  "assume",
  "here",
  "that",
  "segment",
  "files",
  "are",
  "of",
  "a",
  "size",
  "that",
  "a",
  "single",
  "machine",
  "can",
  "handle",
  "exercise",
  "46",
  "finally",
  "the",
  "list",
  "of",
  "values",
  "is",
  "sorted",
  "for",
  "each",
  "key",
  "and",
  "written",
  "to",
  "the",
  "final",
  "sorted",
  "postings",
  "list",
  "postings",
  "in",
  "the",
  "figure",
  "note",
  "that",
  "postings",
  "in",
  "figure",
  "46",
  "include",
  "term",
  "frequencies",
  "whereas",
  "each",
  "posting",
  "in",
  "the",
  "other",
  "sections",
  "of",
  "this",
  "chapter",
  "is",
  "simply",
  "a",
  "docid",
  "without",
  "term",
  "frequency",
  "information",
  "the",
  "data",
  "flow",
  "is",
  "shown",
  "for",
  "af",
  "in",
  "figure",
  "45",
  "this",
  "completes",
  "the",
  "construction",
  "of",
  "the",
  "inverted",
  "index",
  "parsers",
  "and",
  "inverters",
  "are",
  "not",
  "separate",
  "sets",
  "of",
  "machines",
  "the",
  "master",
  "identifies",
  "idle",
  "machines",
  "and",
  "assigns",
  "tasks",
  "to",
  "them",
  "the",
  "same",
  "machine",
  "can",
  "be",
  "a",
  "parser",
  "in",
  "the",
  "map",
  "phase",
  "and",
  "an",
  "inverter",
  "in",
  "the",
  "reduce",
  "phase",
  "and",
  "there",
  "are",
  "often",
  "other",
  "jobs",
  "that",
  "run",
  "in",
  "parallel",
  "with",
  "index",
  "construction",
  "so",
  "in",
  "between",
  "being",
  "a",
  "parser",
  "and",
  "an",
  "inverter",
  "a",
  "machine",
  "might",
  "do",
  "some",
  "crawling",
  "or",
  "another",
  "unrelated",
  "task",
  "to",
  "minimize",
  "write",
  "times",
  "before",
  "inverters",
  "reduce",
  "the",
  "data",
  "each",
  "parser",
  "writes",
  "its",
  "segment",
  "files",
  "to",
  "its",
  "local",
  "disk",
  "in",
  "the",
  "reduce",
  "phase",
  "the",
  "master",
  "communicates",
  "to",
  "an",
  "inverter",
  "the",
  "locations",
  "of",
  "the",
  "relevant",
  "segment",
  "files",
  "eg",
  "of",
  "the",
  "segment",
  "files",
  "of",
  "the",
  "af",
  "partition",
  "each",
  "segment",
  "file",
  "only",
  "requires",
  "one",
  "sequential",
  "read",
  "because",
  "all",
  "data",
  "relevant",
  "to",
  "a",
  "particular",
  "inverter",
  "were",
  "written",
  "to",
  "a",
  "single",
  "segment",
  "file",
  "by",
  "the",
  "parser",
  "this",
  "setup",
  "minimizes",
  "the",
  "amount",
  "of",
  "network",
  "traffic",
  "needed",
  "during",
  "indexing",
  "map",
  "and",
  "reduce",
  "functions",
  "in",
  "mapreduce",
  "in",
  "general",
  "the",
  "map",
  "function",
  "produces",
  "a",
  "list",
  "of",
  "keyvalue",
  "pairs",
  "all",
  "values",
  "for",
  "a",
  "key",
  "are",
  "collected",
  "into",
  "one",
  "list",
  "in",
  "the",
  "reduce",
  "phase",
  "this",
  "list",
  "is",
  "then",
  "processed",
  "further",
  "the",
  "instantiations",
  "of",
  "the",
  "two",
  "functions",
  "and",
  "an",
  "example",
  "are",
  "shown",
  "for",
  "index",
  "construction",
  "because",
  "the",
  "map",
  "phase",
  "processes",
  "documents",
  "in",
  "a",
  "distributed",
  "fashion",
  "termiddocid",
  "pairs",
  "need",
  "not",
  "be",
  "ordered",
  "correctly",
  "initially",
  "as",
  "in",
  "this",
  "example",
  "the",
  "example",
  "shows",
  "terms",
  "instead",
  "of",
  "termids",
  "for",
  "better",
  "readability",
  "we",
  "abbreviate",
  "caesar",
  "as",
  "c",
  "and",
  "conquered",
  "as",
  "ced",
  "figure",
  "46",
  "shows",
  "the",
  "general",
  "schema",
  "of",
  "the",
  "mapreduce",
  "functions",
  "input",
  "and",
  "output",
  "are",
  "often",
  "lists",
  "of",
  "keyvalue",
  "pairs",
  "themselves",
  "so",
  "that",
  "several",
  "mapreduce",
  "jobs",
  "can",
  "run",
  "in",
  "sequence",
  "in",
  "fact",
  "this",
  "was",
  "the",
  "design",
  "of",
  "the",
  "google",
  "indexing",
  "system",
  "in",
  "2004",
  "what",
  "we",
  "describe",
  "in",
  "this",
  "section",
  "corresponds",
  "to",
  "only",
  "one",
  "of",
  "five",
  "to",
  "ten",
  "mapreduce",
  "operations",
  "in",
  "that",
  "indexing",
  "system",
  "another",
  "mapreduce",
  "operation",
  "transforms",
  "the",
  "termpartitioned",
  "index",
  "we",
  "just",
  "created",
  "into",
  "a",
  "documentpartitioned",
  "one",
  "mapreduce",
  "offers",
  "a",
  "robust",
  "and",
  "conceptually",
  "simple",
  "framework",
  "for",
  "implementing",
  "index",
  "construction",
  "in",
  "a",
  "distributed",
  "environment",
  "by",
  "providing",
  "a",
  "semiautomatic",
  "method",
  "for",
  "splitting",
  "index",
  "construction",
  "into",
  "smaller",
  "tasks",
  "it",
  "can",
  "scale",
  "to",
  "almost",
  "arbitrarily",
  "large",
  "collections",
  "given",
  "computer",
  "clusters",
  "of",
  "sufficient",
  "size",
  "exercises",
  "for",
  "splits",
  "segments",
  "and",
  "term",
  "partitions",
  "how",
  "long",
  "would",
  "distributed",
  "index",
  "creation",
  "take",
  "for",
  "reutersrcv1",
  "in",
  "a",
  "mapreduce",
  "architecture",
  "base",
  "your",
  "assumptions",
  "about",
  "cluster",
  "machines",
  "on",
  "table",
  "41",
  "next",
  "dynamic",
  "indexing",
  "up",
  "index",
  "construction",
  "previous",
  "singlepass",
  "inmemory",
  "indexing",
  "contents",
  "index",
  "2008",
  "cambridge",
  "university",
  "pressthis",
  "is",
  "an",
  "automatically",
  "generated",
  "page",
  "in",
  "case",
  "of",
  "formatting",
  "errors",
  "you",
  "may",
  "want",
  "to",
  "look",
  "at",
  "the",
  "pdf",
  "edition",
  "of",
  "the",
  "book",
  "20090407"
]